<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Kreise im Raster mit Regler</title>
<style>
  .grid-container {
    display: grid;
    grid-template-columns: repeat(20, 30px);
    grid-template-rows: repeat(20, 30px);
    gap: 0;
  }
  .circle {
    width: 30px;
    height: 30px;
    background-color: gray;
    border-radius: 50%;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
  }
  #speedControl {
    margin: 20px 0;
  }
</style>
</head>
<body>

<div id="grid" class="grid-container"></div>
<label for="speedControl">Animationsgeschwindigkeit:</label>
<input type="range" id="speedControl" min="0.1" max="1000" value="20">

<script>
  const grid = document.getElementById('grid');
  let circles = [];
  let timeouts = [];

  function createCircles() {
    grid.innerHTML = '';
    circles = [];
    timeouts.forEach(clearTimeout); // Clear existing timeouts
    timeouts = [];

    for (let i = 0; i < 400; i++) {
      const circle = document.createElement('div');
      circle.className = 'circle';
      circle.dataset.index = i + 1;
      grid.appendChild(circle);
      circles.push(circle);
    }
  }

  function startAnimation(speed) {
    let delay = 1000 / speed;
    let step = (1000 - 100) / 200; // Delay decrement step

    circles.forEach((circle, index) => {
      let timeout = setTimeout(() => {
        circle.style.opacity = 1;
      }, delay);

      timeouts.push(timeout);

      if (index < 200) {
        delay = Math.max(100, delay - step);
      } else {
        delay = Math.min(1000, delay + step);
      }
    });
  }

  // Initialize circles and start animation
  createCircles();
  startAnimation(50); // Start with medium speed

  // Speed control
  document.getElementById('speedControl').addEventListener('input', function() {
    createCircles(); // Recreate circles to restart the animation
    startAnimation(this.value);
  });
</script>

</body>
</html>